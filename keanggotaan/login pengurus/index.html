<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Login Pengurus - HC 32</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/3.5.0/remixicon.css" rel="stylesheet">

  <script src="../../config.js"></script>
  <script src="../../components.js"></script>

  <style>
    /* Variabel Warna dari Brand Guide */
    :root {
        --hc-blue: #1a4787;
        --hc-toska: #0f8a94;
        --hc-dark: #2e2e2e;
        --hc-bg: #e7e9ea;
        --card-shadow: 0 8px 30px rgba(26, 71, 135, 0.08);
    }

    body {
        font-family: 'Poppins', system-ui, -apple-system, sans-serif;
        background-color: var(--hc-bg);
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
    }

    /* Container Utama */
    .login-wrapper {
        flex: 1;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding: 40px 20px;
        gap: 20px;
    }

    .login-card, .help-card {
        width: 100%;
        max-width: 600px;
        box-sizing: border-box;
    }

    /* Kartu Login */
    .login-card {
        background: white;
        border-radius: 16px;
        box-shadow: var(--card-shadow);
        border: 1px solid #cbd5e1;
        padding: 30px;
        text-align: center;
        position: relative;
        overflow: hidden;
    }

    /* Hiasan Atas */
    .login-card::before {
        content: '';
        position: absolute;
        top: 0; left: 0; right: 0;
        height: 6px;
        background: linear-gradient(to right, var(--hc-blue), var(--hc-toska));
    }

    /* Logo Header */
    .login-header-logo {
        width: 100%;
        max-width: 250px;
        height: auto;
        margin: 0 auto 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: transparent;
        box-shadow: none;
        border: none;
    }
    .login-header-logo img {
        width: 100%;
        height: auto;
        object-fit: contain;
    }

    .login-title {
        font-size: 24px;
        font-weight: 700;
        color: var(--hc-dark);
        margin-bottom: 8px;
    }
    .login-subtitle {
        font-size: 14px;
        color: #64748b;
        margin-bottom: 30px;
        font-weight: 300;
    }

    /* Form Group */
    .form-group {
        text-align: left;
        margin-bottom: 20px;
    }
    .form-label {
        display: block;
        font-size: 13px;
        font-weight: 600;
        color: var(--hc-dark);
        margin-bottom: 8px;
    }
    .input-wrapper {
        position: relative;
    }
    .input-icon {
        position: absolute;
        left: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: #94a3b8;
        font-size: 18px;
    }
    
    .toggle-password {
        position: absolute;
        right: 16px;
        top: 50%;
        transform: translateY(-50%);
        color: #94a3b8;
        font-size: 18px;
        cursor: pointer;
        padding: 5px;
        user-select: none;
    }
    .toggle-password:hover {
        color: var(--hc-blue);
    }

    .form-input {
        width: 100%;
        padding: 12px 40px 12px 44px;
        border: 1px solid #cbd5e1;
        border-radius: 10px;
        font-size: 15px;
        outline: none;
        transition: all 0.2s;
        box-sizing: border-box;
        font-family: 'Poppins', sans-serif;
    }
    .form-input:focus {
        border-color: var(--hc-blue);
        box-shadow: 0 0 0 3px rgba(26, 71, 135, 0.15);
    }

    /* Tombol */
    .btn-login {
        width: 100%;
        padding: 16px;
        border: none;
        border-radius: 10px;
        background: linear-gradient(135deg, var(--hc-blue), var(--hc-toska));
        color: white;
        font-weight: 600;
        font-size: 16px;
        cursor: pointer;
        transition: transform 0.2s, box-shadow 0.2s;
        margin-top: 10px;
        font-family: 'Poppins', sans-serif;
        box-shadow: 0 4px 15px rgba(15, 138, 148, 0.3);
    }
    .btn-login:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(15, 138, 148, 0.4);
    }
    .btn-login:active {
        transform: scale(0.98);
    }
    .btn-login:disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    /* Link */
    .link-lupa {
        font-size: 12px; color: var(--hc-blue); text-decoration: none; 
        font-weight: 600; float: right; margin-top: 5px; cursor: pointer;
    }
    .link-lupa:hover { text-decoration: underline; }
    
    .link-back {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        margin-top: 12px;
        font-size: 12px;
        color: #64748b;
        text-decoration: none;
        font-weight: 600;
    }
    .link-back:hover { color: var(--hc-blue); }

    /* HELP CARD */
    .help-card {
        background: #fff; 
        border-radius: 16px;
        box-shadow: 0 2px 5px rgba(0,0,0,0.05); 
        padding: 16px 20px;
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        justify-content: space-between; 
        gap: 12px;
        border-left: 4px solid var(--hc-blue);
    }
    @media (min-width: 600px) { .help-card { flex-direction: row; } }
    
    .help-title { font-weight: 600; font-size: 14px; color: var(--hc-dark); margin: 0; }
    .help-desc { font-size: 12px; color: #64748b; margin: 2px 0 0; }
    .help-link { color: var(--hc-blue); font-weight: 600; text-decoration: none; }
    .help-btn { 
        display: inline-flex; 
        align-items: center; 
        gap: 8px; 
        background: var(--hc-blue); 
        color: white; 
        padding: 8px 16px; 
        border-radius: 8px; 
        font-size: 13px; 
        font-weight: 500; 
        text-decoration: none; 
        transition: 0.2s; 
    }
    .help-btn:hover { opacity: 0.9; }

    /* Modal OTP & Reset */
    .modal-overlay {
        position: fixed; inset: 0; background: rgba(0,0,0,0.6);
        display: none; align-items: center; justify-content: center; z-index: 2000;
        backdrop-filter: blur(3px);
    }
    .modal-overlay.active { display: flex; }
    .modal-card {
        background: white; width: 90%; max-width: 400px; padding: 25px;
        border-radius: 16px; position: relative; text-align: center;
        box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        animation: slideUp 0.3s ease-out;
    }
    @keyframes slideUp { from {transform: translateY(20px); opacity:0;} to {transform: translateY(0); opacity:1;} }
    
    .otp-inputs { display: flex; justify-content: center; gap: 8px; margin: 20px 0; }
    .otp-input {
        width: 45px; height: 50px; border: 1px solid #cbd5e1; border-radius: 8px;
        font-size: 24px; text-align: center; font-weight: bold; color: var(--hc-blue);
    }
    .otp-input:focus { border-color: var(--hc-toska); outline: none; box-shadow: 0 0 0 3px rgba(15,138,148,0.1); }

    /* UTIL */
    .hidden { display: none !important; }
    
    .reset-info {
      margin: 10px 0 18px;
      padding: 12px 14px;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      border-radius: 12px;
      text-align: left;
      font-size: 12px;
      color: #475569;
    }
    .reset-info strong { color: var(--hc-dark); }
    .small-note {
      margin: 10px 0 0;
      font-size: 12px;
      color: #94a3b8;
      font-style: italic;
      text-align: left;
    }
  </style>
</head>
<body>

  <div class="login-wrapper">
      
      <div class="login-card" id="card-login">
          <div class="login-header-logo">
              <img src="https://drive.google.com/thumbnail?id=1kb_yesHbnVPtCrjzlWZGD_XXtfQoaLEe&sz=w600" alt="History Club 32">
          </div>
          
          <h2 class="login-title">Login Pengurus</h2>
          <p class="login-subtitle">Masuk untuk mengakses Dashboard HC 32</p>

          <form id="login-form" onsubmit="event.preventDefault();">
              <div class="form-group">
                  <label class="form-label">ID HC / Username</label>
                  <div class="input-wrapper">
                      <i class="ri-user-line input-icon"></i>
                      <input id="login-username" type="text" class="form-input" placeholder="Masukkan ID Pengurus" required autocomplete="username">
                  </div>
              </div>

              <div class="form-group">
                  <label class="form-label">Kata Sandi</label>
                  <div class="input-wrapper">
                      <i class="ri-lock-line input-icon"></i>
                      <input id="login-password" type="password" class="form-input" placeholder="Masukkan Kata Sandi" required autocomplete="current-password">
                      <i class="ri-eye-off-line toggle-password" id="toggle-password" title="Lihat Password"></i>
                  </div>
              </div>

              <button type="submit" id="login-btn" class="btn-login">Masuk Sekarang</button>
          </form>

          <div style="margin-top: 15px; text-align: right;">
              <a href="#" class="link-lupa" onclick="openResetModal()">Lupa Kata Sandi?</a>
          </div>
      </div>

      <div class="login-card hidden" id="card-reset">
          <div class="login-header-logo">
              <img src="https://drive.google.com/thumbnail?id=1kb_yesHbnVPtCrjzlWZGD_XXtfQoaLEe&sz=w600" alt="History Club 32">
          </div>
          <h2 class="login-title">Reset Kata Sandi</h2>
          <p class="login-subtitle" id="reset-subtitle">Memeriksa tautan reset...</p>
          
          <div class="reset-info" id="reset-info-box">
            <div><strong>Status:</strong> <span id="reset-status-text">Memvalidasi token</span></div>
            <div style="margin-top:6px;"><strong>Email:</strong> <span id="reset-email-text">-</span></div>
            <div style="margin-top:4px;"><strong>Username:</strong> <span id="reset-user-text">-</span></div>
          </div>

          <form id="reset-form" onsubmit="event.preventDefault();">
              <div class="form-group">
                  <label class="form-label">Kata Sandi Baru</label>
                  <div class="input-wrapper">
                      <i class="ri-lock-password-line input-icon"></i>
                      <input id="reset-pass-1" type="password" class="form-input" placeholder="Minimal 8 karakter" autocomplete="new-password">
                      <i class="ri-eye-off-line toggle-reset" data-target="reset-pass-1" title="Lihat Password"></i>
                  </div>
              </div>

              <div class="form-group">
                  <label class="form-label">Ulangi Kata Sandi Baru</label>
                  <div class="input-wrapper">
                      <i class="ri-lock-password-line input-icon"></i>
                      <input id="reset-pass-2" type="password" class="form-input" placeholder="Harus sama persis" autocomplete="new-password">
                      <i class="ri-eye-off-line toggle-reset" data-target="reset-pass-2" title="Lihat Password"></i>
                  </div>
              </div>

              <button type="submit" id="btn-reset-submit" class="btn-login" disabled>Simpan Kata Sandi</button>
              
              <p class="small-note">Jika tautan reset sudah kedaluwarsa, minta tautan reset baru.</p>
              
              <a class="link-back" href="./index.html">
                <i class="ri-arrow-left-line"></i> Kembali ke Login
              </a>
          </form>
      </div>

      <div class="help-card" id="help-card">
          <div style="flex:1;">
              <p class="help-title">Butuh Bantuan?</p>
              <p class="help-desc">Hubungi Ketua HC <a href="https://instagram.com/mickovoitto" target="_blank" class="help-link">@mickovoitto</a> jika mengalami kendala sistem.</p>
          </div>
          <a href="https://www.instagram.com/historyclub32jkt/" target="_blank" class="help-btn">
              Instagram HC 32
              <i class="ri-instagram-line"></i>
          </a>
      </div>

  </div>

  <div class="modal-overlay" id="modal-otp-request">
      <div class="modal-card">
          <button onclick="closeOtpModal()" style="position:absolute; top:15px; right:15px; border:none; background:none; font-size:24px; cursor:pointer;">&times;</button>
          <h3 style="margin-top:0; color:var(--hc-blue);">Reset Kata Sandi</h3>
          <p style="font-size:13px; color:#64748b; margin-bottom:20px;">Masukkan ID Pengurus Anda (Username/NIS/Email). Kami akan mengirimkan tautan reset ke email yang terdaftar.</p>
        
          <input type="text" id="otp-username-req" class="form-input" placeholder="Masukkan ID Pengurus" style="text-align:center; margin-bottom:15px;">
        
          <button onclick="requestReset()" class="btn-login" id="btn-req-otp">Kirim Tautan Reset</button>
      </div>
   </div>

   <div class="modal-overlay" id="modal-otp-verify">
       <div class="modal-card">
           <h3 style="margin-top:0; color:var(--hc-blue);">Verifikasi Login</h3>
           <p style="font-size:13px; color:#64748b;">Masukkan 6 digit kode yang dikirim ke <br><strong id="otp-email-display">email</strong></p>
        
           <div class="otp-inputs" id="otp-container">
               <input type="text" class="otp-input" maxlength="1" oninput="digitInput(this,1)">
               <input type="text" class="otp-input" maxlength="1" oninput="digitInput(this,2)">
               <input type="text" class="otp-input" maxlength="1" oninput="digitInput(this,3)">
               <input type="text" class="otp-input" maxlength="1" oninput="digitInput(this,4)">
               <input type="text" class="otp-input" maxlength="1" oninput="digitInput(this,5)">
               <input type="text" class="otp-input" maxlength="1" oninput="digitInput(this,6)">
           </div>
        
           <button onclick="verifyOtp()" class="btn-login">Verifikasi & Masuk</button>
       </div>
   </div>

  <script>
    // Inisialisasi Navigasi
    document.addEventListener('DOMContentLoaded', () => initHC32Navigation('login'));

    // AMBIL API URL dari Config.js, Jika tidak ada pakai placeholder
    const API_URL = (typeof GAS_URL !== 'undefined') ? GAS_URL : "URL_APPS_SCRIPT_ANDA";
    const DASHBOARD_BASE = "https://historyclub32.github.io/pengurus/dashboard.html";

    // ===============
    // HELPER: POST JSON with TEXT/PLAIN Header (FIX CORS)
    // ===============
    async function postJson(payload) {
      try {
        const res = await fetch(API_URL, {
          method: "POST",
          headers: { "Content-Type": "text/plain" }, // PENTING: text/plain
          body: JSON.stringify(payload)
        });
        if (!res.ok) throw new Error("HTTP " + res.status);
        return await res.json();
      } catch (e) {
        throw e; // Lempar error agar ditangkap catch block pemanggil
      }
    }

    // ===============
    // MODE DETECTOR (Untuk Halaman Reset Password via Email)
    // ===============
    const params = new URLSearchParams(window.location.search);
    const isResetMode = params.get('reset') === '1';
    const resetToken = (params.get('token') || '').trim();

    const cardLogin = document.getElementById('card-login');
    const cardReset = document.getElementById('card-reset');

    if (isResetMode) {
      if (cardLogin) cardLogin.classList.add('hidden');
      if (cardReset) cardReset.classList.remove('hidden');
    } else {
      if (cardReset) cardReset.classList.add('hidden');
      if (cardLogin) cardLogin.classList.remove('hidden');
    }

    // --- FITUR LIHAT PASSWORD (Login & Reset) ---
    function setupToggle(toggleId, inputId) {
        const toggle = document.getElementById(toggleId);
        const input = document.getElementById(inputId);
        if (toggle && input) {
            toggle.addEventListener('click', function() {
                const type = input.getAttribute('type') === 'password' ? 'text' : 'password';
                input.setAttribute('type', type);
                this.classList.toggle('ri-eye-line');
                this.classList.toggle('ri-eye-off-line');
            });
        }
    }
    setupToggle('toggle-password', 'login-password');
    setupToggle('toggle-reset-1', 'reset-pass-1');
    setupToggle('toggle-reset-2', 'reset-pass-2');

    // Variable global untuk menyimpan username asli dari backend (OTP flow)
    let currentOtpUser = '';

    // =========================
    // RESET MODE FLOW (Saat user klik link dari email)
    // =========================
    const resetStatusText = document.getElementById('reset-status-text');
    const resetEmailText = document.getElementById('reset-email-text');
    const resetUserText = document.getElementById('reset-user-text');
    const resetSubtitle = document.getElementById('reset-subtitle');
    const btnResetSubmit = document.getElementById('btn-reset-submit');
    const resetForm = document.getElementById('reset-form');
    let resetTokenValidated = false;

    async function verifyResetTokenFront_() {
      if (!isResetMode) return;
      
      if (!resetToken) {
        if (resetSubtitle) resetSubtitle.innerText = 'Token tidak ditemukan pada URL.';
        window.showHC32Status('error', 'Token Tidak Ada', 'Tautan reset tidak lengkap.');
        return;
      }

      window.showHC32Status('loading', 'Memvalidasi...', 'Mohon tunggu sebentar.');

      try {
        const out = await postJson({
          action: "verifyResetTokenAdmin",
          token: resetToken
        });

        // Backend harus return { status:'ok', valid: true/false }
        if (out && out.status === 'ok' && out.valid === true) {
          window.hideHC32Status(); // Hilangkan loading
          resetTokenValidated = true;
          if (resetSubtitle) resetSubtitle.innerText = 'Silakan buat kata sandi baru.';
          if (resetStatusText) resetStatusText.innerText = 'Token Valid';
          if (resetEmailText) resetEmailText.innerText = out.email || '(Terkonfirmasi)';
          if (resetUserText) resetUserText.innerText = out.username || '(Terkonfirmasi)';
          if (btnResetSubmit) btnResetSubmit.disabled = false;
        } else {
          // Token Invalid / Expired
          resetTokenValidated = false;
          if (resetSubtitle) resetSubtitle.innerText = 'Tautan reset kedaluwarsa.';
          if (resetStatusText) resetStatusText.innerText = 'Tidak Valid';
          if (btnResetSubmit) btnResetSubmit.disabled = true;
          window.showHC32Status('error', 'Gagal', (out && out.message) ? out.message : 'Token tidak valid.');
        }
      } catch (e) {
        resetTokenValidated = false;
        window.showHC32Status('error', 'Koneksi Gagal', 'Tidak dapat menghubungi server. Coba refresh.');
      }
    }

    async function submitResetPasswordFront_() {
      if (!isResetMode) return;
      const p1 = (document.getElementById('reset-pass-1')?.value || '').trim();
      const p2 = (document.getElementById('reset-pass-2')?.value || '').trim();

      if (!resetTokenValidated) {
        window.showHC32Status('error', 'Token Invalid', 'Refresh halaman dan coba lagi.');
        return;
      }
      if (!p1 || !p2) {
        window.showHC32Status('error', 'Data Kosong', 'Isi kata sandi baru.');
        return;
      }
      if (p1.length < 8) {
        window.showHC32Status('error', 'Terlalu Pendek', 'Kata sandi minimal 8 karakter.');
        return;
      }
      if (p1 !== p2) {
        window.showHC32Status('error', 'Tidak Cocok', 'Konfirmasi kata sandi harus sama.');
        return;
      }

      window.showHC32Status('loading', 'Menyimpan...', 'Mengubah kata sandi Anda.');

      try {
        const out = await postJson({
          action: "resetPasswordAdmin",
          token: resetToken,
          newPassword: p1
        });

        if (out && out.status === 'ok') {
          window.showHC32Status('success', 'Berhasil!', 'Kata sandi diubah. Login ulang...');
          setTimeout(() => {
            const cleanUrl = new URL(window.location.href);
            cleanUrl.searchParams.delete('reset');
            cleanUrl.searchParams.delete('token');
            window.location.href = cleanUrl.toString();
          }, 2000);
        } else {
          window.showHC32Status('error', 'Gagal', (out && out.message) ? out.message : 'Gagal reset password.');
        }
      } catch (e) {
        window.showHC32Status('error', 'Koneksi Gagal', e.message);
      }
    }

    if (resetForm) {
      resetForm.addEventListener('submit', (e) => {
        e.preventDefault();
        submitResetPasswordFront_();
      });
    }

    if (isResetMode) {
      verifyResetTokenFront_();
    }

    // =========================
    // LOGIN FLOW (PASSWORD -> OTP)
    // =========================
    const loginForm = document.getElementById("login-form");
    if(loginForm) {
      loginForm.addEventListener("submit", async (e) => {
        e.preventDefault();
        const u = document.getElementById("login-username").value.trim();
        const p = document.getElementById("login-password").value.trim();

        if (!u || !p) {
            window.showHC32Status('error', 'Data Belum Lengkap', 'Mohon isi ID dan Kata Sandi.');
            return;
        }

        window.showHC32Status('loading', 'Memeriksa Akun...', 'Mohon tunggu sebentar.');

        try {
            const out = await postJson({
                action: "loginAdmin",
                username: u,
                password: p
            });
            
            if (out.status === "otp_required") {
                window.hideHC32Status();
                currentOtpUser = out.real_username || u;
                document.getElementById('otp-email-display').innerText = out.email || 'email terdaftar';
                
                document.getElementById('modal-otp-request').classList.remove('active'); 
                document.getElementById('modal-otp-verify').classList.add('active');
                
                setTimeout(() => {
                    const firstInput = document.querySelector('.otp-input');
                    if(firstInput) firstInput.focus();
                }, 300);

            } else if (out.status === "ok") {
                handleLoginSuccess(out);
            } else {
                window.showHC32Status('error', 'Login Gagal', out.message);
            }

        } catch (err) {
            console.error(err);
            window.showHC32Status('error', 'Kesalahan Koneksi', 'Gagal menghubungi server.');
        }
      });
    }

    function handleLoginSuccess(out) {
      window.showHC32Status('success', 'Login Berhasil!', 'Mengarahkan ke Dashboard...');
      const url = new URL(DASHBOARD_BASE);
      url.searchParams.set("token", out.token);
      url.searchParams.set("u", out.username);
      url.searchParams.set("n", out.nama);
      url.searchParams.set("r", out.role);
      url.searchParams.set("t", out.tipe || "");
      url.searchParams.set("j", out.jabatan || "Admin");
      url.searchParams.set("f", out.foto || "");

      setTimeout(() => {
        window.open(url.toString(), "_blank");
        window.location.reload(); 
      }, 1500);
    }

    // =========================
    // MODAL & FUNGSI (Reset & OTP)
    // =========================
    window.openResetModal = function() {
        document.getElementById('modal-otp-request').classList.add('active');
        const mainUser = document.getElementById('login-username').value;
        if(mainUser) document.getElementById('otp-username-req').value = mainUser;
    }

    window.closeOtpModal = function() {
        document.getElementById('modal-otp-request').classList.remove('active');
    }

    window.digitInput = function(el, idx) {
        el.value = el.value.replace(/[^0-9]/g, '');
        if(el.value.length >= 1) {
            const next = el.nextElementSibling;
            if(next) next.focus();
        }
    }

    window.requestReset = async function() {
        const user = document.getElementById('otp-username-req').value.trim();
        if(!user) {
            window.showHC32Status('error', 'Data Kosong', 'Masukkan ID Pengurus/Email/NIS.');
            return;
        }

        const btn = document.getElementById('btn-req-otp');
        const originalText = btn.innerText;
        btn.innerText = "Mengirim...";
        btn.disabled = true;

        try {
            const out = await postJson({ action: "requestOtpAdmin", username: user });
            
            if(out && out.status === 'ok') {
                window.closeOtpModal();
                window.showHC32Status('success', 'Email Terkirim', 'Silakan cek email Anda untuk tautan reset kata sandi.');
            } else {
                window.showHC32Status('error', 'Gagal', (out && out.message) ? out.message : 'Terjadi kesalahan.');
            }
        } catch(e) {
            window.showHC32Status('error', 'Error', e.message);
        }
        btn.innerText = originalText;
        btn.disabled = false;
    }

    window.verifyOtp = async function() {
        let code = '';
        document.querySelectorAll('.otp-input').forEach(i => code += i.value);
        
        if(code.length < 6) {
            window.showHC32Status('error', 'Kode Tidak Lengkap', 'Masukkan 6 digit kode OTP.');
            return;
        }

        window.showHC32Status('loading', 'Verifikasi...', 'Memeriksa kode OTP.');

        try {
             const out = await postJson({
                action: "verifyOtpAdmin",
                username: currentOtpUser,
                otp: code
            });

            if (out && out.status === "ok") {
                handleLoginSuccess(out);
            } else {
                window.showHC32Status('error', 'Verifikasi Gagal', (out && out.message) ? out.message : 'Kode OTP Salah.');
                document.querySelectorAll('.otp-input').forEach(i => i.value = '');
                document.querySelector('.otp-input')?.focus();
            }
        } catch(e) {
             window.showHC32Status('error', 'Error', e.message);
        }
    }
  </script>
</body>
</html>
